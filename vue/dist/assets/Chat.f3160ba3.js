import{_,o,c,i as I,a as m,t as x,n as p,r,F as y,j as M,b as n,g as l,s as U,w as b,f as S}from"./index.ae1caef1.js";import C from"./ChatList.dc2516b7.js";const w={name:"Message",props:{message:{type:Object},userId:{type:String}}},V={key:0,height:"40",class:"border-round-3xl mr-2",src:"http://localhost:8081/public/images/profile1.jpg",alt:""};function k(e,t,s,h,a,i){return o(),c("div",{class:p("flex "+(s.message.user_id==s.userId?"justify-content-end":" "))},[s.message.user_id!=s.userId?(o(),c("img",V)):I("",!0),m("div",{class:p("card p-3 text-md "+(s.message.user_id==s.userId?"bg-blue-500":"bg-blue-200"))},x(s.message.message),3)],2)}const j=_(w,[["render",k]]),B={name:"Messages",props:{messages:{type:Array},userId:{type:String}},components:{Message:j}},T={class:"card pt-5 px-5 p-fluid bg-white",style:{height:"700px",overflow:"auto"}};function N(e,t,s,h,a,i){const u=r("Message"),g=r("ScrollTop");return o(),c("div",T,[(o(!0),c(y,null,M(s.messages,d=>(o(),c("div",{key:d.id},[n(u,{message:d,userId:s.userId},null,8,["message","userId"])]))),128)),n(g,{target:"parent",threshold:200})])}const E=_(B,[["render",N]]),F={name:"Chat",components:{Messages:E,Users:C},data(){return{messages:[],message:"",userId:null,receiver:0}},watch:{receiver(e){l.get("/api/messages",{params:{receiver_id:e.id}}).then(t=>{this.messages=t.data})}},created(){l.get("/api/users").then(e=>{this.users=e.data,this.receiver=this.users[0],l.get("/api/messages",{params:{receiver_id:this.receiver.id}}).then(t=>{this.messages=t.data})}),this.userId=U.state.auth.user.data.id,console.log(this.userId),window.Echo.private("chat."+this.userId).listen("MessageSent",e=>{let t={message:e.message,user_id:e.sender_id};this.messages.push(t)})},methods:{selectUser(e){console.log(e),this.receiver=e},sendMessage(){l.post("/api/messages",{message:this.message,receiver_id:this.receiver.id}).then(e=>{this.messages.push({message:this.message,user_id:this.userId}),console.log(e.data),this.message=""})}}},$={class:"grid"},z={class:"md:col-10 col-12"},A={class:"flex justify-content-end"};function D(e,t,s,h,a,i){const u=r("Users"),g=r("Messages"),d=r("InputText"),f=r("Button");return o(),c("div",null,[m("div",$,[n(u,{onSelectUser:i.selectUser,class:"md:col-2 col-12",users:e.users,selectedUserId:a.receiver.id},null,8,["onSelectUser","users","selectedUserId"]),m("div",z,[n(g,{messages:a.messages,userId:a.userId},null,8,["messages","userId"]),m("div",A,[n(d,{class:"mr-1",modelValue:a.message,"onUpdate:modelValue":t[0]||(t[0]=v=>a.message=v)},null,8,["modelValue"]),n(f,{onClick:i.sendMessage},{default:b(()=>[S("Send")]),_:1},8,["onClick"])])])])])}const q=_(F,[["render",D]]);export{q as default};
