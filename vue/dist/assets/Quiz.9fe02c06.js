import{_ as d,o as n,c as r,a as o,t as u,n as x,r as a,i as w,g as q,F as z,j as m,b as l}from"./index.72b1626b.js";const I={name:"Question",props:{question:{type:Object}}},g={class:"w-10 card bg-white py-4 px-6"},b=o("h4",null,"Question:",-1);function v(e,i,s,h,t,c){return n(),r("div",g,[b,o("p",null,u(s.question.text),1)])}const Q=d(I,[["render",v]]),y={data(){return{classes:null}},props:{choice:{type:Object},selectedChoice:{type:Object},correctChoice:{type:Object}},watch:{selectedChoice:{handler(e){this.classes=this.selectedChoice&&this.selectedChoice.id==this.choice.id?"surface-300 ":"bg-white"},immediate:!0}},computed:{correctChoice(){return this.correctChoice&&this.correctChoice.id==this.choice.id?(this.classes=null,"bg-green-500"):this.correctChoice&&this.correctChoice.id!=this.choice.id&&this.selectedChoice.id==this.choice.id?(this.classes=null,"bg-red-500"):""}},name:"Choice"};function k(e,i,s,h,t,c){return n(),r("div",{class:x("w-9 card py-4 px-6 cursor-pointer hover:surface-400 "+t.classes+" "+c.correctChoice),onClick:i[0]||(i[0]=_=>e.$emit("selectAnswer",s.choice))},[o("p",null,u(s.choice.text),1)],2)}const P=d(y,[["render",k]]),S={name:"Choices",props:{choices:{type:Array},selectedChoice:{type:Object},correctChoice:{type:Object}},components:{Choice:P}};function j(e,i,s,h,t,c){const _=a("Choice");return n(!0),r(z,null,w(s.choices,p=>(n(),q(_,{selectedChoice:s.selectedChoice,correctChoice:s.correctChoice,onSelectAnswer:f=>e.$emit("selectAnswer",p),choice:p},null,8,["selectedChoice","correctChoice","onSelectAnswer","choice"]))),256)}const A=d(S,[["render",j]]),D={name:"QuizStat",props:{totalPoints:{type:Number},duration:{type:Number}}},$={class:"w-7 pa-7 bg-white text-xl cursor-pointer p-5 m-4 border-round transition-all transition-duration-200 hover:bg-gray-100 shadow-4 hover:shadow-6"},F=o("h3",{class:"text-center mb-5"},"Result",-1),B={class:"flex justify-content-between"},O=o("p",null,"Total points:",-1),E={class:"flex justify-content-between"},N=o("p",null,"Duration:",-1);function R(e,i,s,h,t,c){return n(),r("div",$,[F,o("div",B,[O,o("p",null,u(s.totalPoints),1)]),o("div",E,[N,o("p",null,u(parseInt(s.duration/1e3/60)+"mn")+" "+u(s.duration/1e3%60+"s"),1)])])}const T=d(D,[["render",R]]),V={name:"Quiz",components:{Question:Q,Choices:A,QuizStat:T},data(){return{quizId:null,courseId:null,quizFinished:!1,showError:!1,currentIndex:0,questions:[],totalPoints:0,answers:[],duration:0,startDuration:null,timerId:null,quizDone:!1,correctChoice:null,stats:{duration:0,totalPoints:0}}},watch:{currentIndex(e){e==this.questions.length&&this.finishQuiz()},duration(e){e==0&&this.finishQuiz()}},created(){let e=this.$route.params.courseId,i=this.$route.params.quizId;this.quizId=i,this.courseId=e,m.get("api/course/"+e+"/quiz/"+i+"/doneQuiz").then(s=>{if(!s.data){m.get("api/course/"+e+"/quiz/"+i).then(h=>{this.questions=h.data.questions,this.duration=this.startDuration=h.data.duration*60*1e3,this.timerId=setInterval(()=>{this.duration=this.duration-1e3},1e3)});return}this.quizDone=!0,this.stats.totalPoints=s.data.pivot.mark,this.stats.duration=s.data.pivot.time})},methods:{finishQuiz(){this.quizFinished=!0,clearInterval(this.timerId),this.getScore(),this.saveQuizResult()},saveQuizResult(){m.put("/api/course/"+this.courseId+"/quiz/"+this.quizId+"/saveResult",{mark:this.stats.totalPoints,time:this.stats.duration}).then(e=>{console.log(e)})},getScore(){let e=this.answers.filter(i=>i.is_correct);this.totalPoints=e.length,this.stats.totalPoints=e.length,this.stats.duration=this.startDuration-this.duration},selectAnswer(e){this.correctChoice||(this.answers[this.currentIndex]=e)},confirmChoice(){let e=this.questions[this.currentIndex].choices.filter(i=>i.is_correct)[0];this.correctChoice=e},nextQuestion(){this.answers[this.currentIndex]?(this.correctChoice=!1,this.showError=!1,m.put("/api/question/"+this.questions[this.currentIndex].id+"/choice/"+this.answers[this.currentIndex].id+"/attach").then(e=>{console.log(e)}),this.currentIndex++):this.showError=!0}}},L={class:"text-red-400"},W={key:0,class:"flex w-8 mx-auto flex-column mt-8 justify-content-center align-items-center"},G={class:"p-card p-3 mb-3 align-self-end"},H={key:1},J={key:2};function K(e,i,s,h,t,c){const _=a("Question"),p=a("Choices"),f=a("Button"),C=a("QuizStat");return n(),r("div",null,[o("p",L,u(t.showError?"please select a choice":""),1),t.questions.length!=0&&!t.quizFinished&&!t.quizDone?(n(),r("div",W,[o("div",G," Time: "+u(parseInt(t.duration/1e3/60)+"mn")+" "+u(t.duration/1e3%60+"s"),1),l(_,{question:t.questions[t.currentIndex]},null,8,["question"]),l(p,{onSelectAnswer:c.selectAnswer,selectedChoice:t.answers[t.currentIndex],choices:t.questions[t.currentIndex].choices,correctChoice:t.correctChoice},null,8,["onSelectAnswer","selectedChoice","choices","correctChoice"]),l(f,{class:"align-self-end",label:"Confirm",onClick:c.confirmChoice},null,8,["onClick"]),l(f,{class:"align-self-end",label:t.currentIndex<t.questions.length-1?"Next":"Finish Quiz",onClick:c.nextQuestion},null,8,["label","onClick"])])):t.quizDone||t.quizFinished?(n(),r("div",H,[l(C,{totalPoints:t.stats.totalPoints,duration:t.stats.duration},null,8,["totalPoints","duration"])])):(n(),r("div",J,"Quiz Will be available sooner."))])}const U=d(V,[["render",K]]);export{U as default};
