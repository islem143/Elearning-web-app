import{_ as f,g as u,o as p,c as m,a as d,h as b,w as h,b as i,i as g,t as k,r as n,p as w,d as D}from"./index.ae1caef1.js";import{M as I}from"./ModulesCard.2feda7ee.js";const V={inject:["role"],components:{ModuleCards:I},data(){return{selectedModule:null,deleteModuleDialog:!1,data:[],search:"",layout:"grid",sortKey:null,sortOrder:null,sortField:null,page:0,count:0,sortOptions:[{label:"Price High to Low",value:"!price"},{label:"Price Low to High",value:"price"}]}},created(){this.getModules(),u.get("/api/module/count").then(e=>{this.count=e.data.count})},methods:{list(e){this.page=e.page,this.getModules()},enroll(e){u.post("/api/module/join",{moduleId:e.id}).then(t=>{this.$toast.add({severity:"success",summary:"you have been entrolled to this module ",life:3e3});let o=this.data.findIndex(l=>l.id==e.id);console.log(o);let a={...this.data[o]};a.users=!0,this.data.splice(o,1,a)})},getModules(){let e={title:this.search,page:this.page+1};if(!this.role){u.get("/api/modules",{params:e}).then(t=>{this.data=t.data.data});return}u.get("/api/module",{params:e}).then(t=>{console.log(t.status),this.data=t.data.data,this.role=="student"&&this.data.forEach(o=>{u.get("/api/module/"+o.id+"/completedCourses").then(a=>{o.totalCourses=a.data.totalCourse,o.completedCourses=a.data.completedCourses})})}).catch(t=>{console.log(t.message)})},src(e){return console.log(e),e.img_url.split("/")[2]},goTo(e){this.$router.push({name:"module-detail",params:{moduleId:e.id}})},editModule(e){this.role=="teacher"&&this.$router.push({name:"module-edit",params:{moduleId:e.id}})},async deleteModule(){await u.delete("/api/module/"+this.selectedModule.id).then(e=>{this.deleteModuleDialog=!1;let t=this.data.findIndex(o=>o.id==this.selectedModule.id);this.data.splice(t,1)})},confirmDeleteModule(e){this.deleteModuleDialog=!0,this.selectedModule=e},onSortChange(e){const t=e.value.value,o=e.value;t.indexOf("!")===0?(this.sortOrder=-1,this.sortField=t.substring(1,t.length),this.sortKey=o):(this.sortOrder=1,this.sortField=t,this.sortKey=o)}}},_=e=>(w("data-v-9337c6eb"),e=e(),D(),e),L={class:"col-12"},N={class:"card"},B=_(()=>d("h3",null,"Modules",-1)),E={class:"flex align-items-center"},P={class:"p-input-icon-right col-4"},S=_(()=>d("i",{class:"pi pi-search"},null,-1)),T={key:0,class:"mt-4 text-2xl"},O=_(()=>d("div",{class:"confirmation-content"},[d("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}}),d("span",null,"Are you sure you want to delete the selected module?")],-1));function F(e,t,o,a,l,s){const c=n("Button"),M=n("router-link"),v=n("InputText"),x=n("module-cards"),y=n("Dialog"),C=n("Paginator");return p(),m("div",L,[d("div",N,[B,d("div",E,[s.role=="teacher"?(p(),b(M,{key:0,to:{name:"module-create"}},{default:h(()=>[i(c,{label:"New Module",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:e.openNew},null,8,["onClick"])]),_:1})):g("",!0),d("div",P,[S,i(v,{type:"text",class:"w-full",modelValue:l.search,"onUpdate:modelValue":t[0]||(t[0]=r=>l.search=r),placeholder:"Search",onInput:s.getModules},null,8,["modelValue","onInput"])])]),l.data.length==0&&l.search?(p(),m("p",T,' No match found for "'+k(l.search)+'". ',1)):g("",!0),i(x,{mylist:!1,onEditModule:s.editModule,onConfirmDeleteModule:s.confirmDeleteModule,onGoTo:s.goTo,onEnroll:s.enroll,modules:l.data},null,8,["onEditModule","onConfirmDeleteModule","onGoTo","onEnroll","modules"]),i(y,{visible:l.deleteModuleDialog,"onUpdate:visible":t[2]||(t[2]=r=>l.deleteModuleDialog=r),style:{width:"450px"},header:"Confirm",modal:!0},{footer:h(()=>[i(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[1]||(t[1]=r=>l.deleteModuleDialog=!1)}),i(c,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:s.deleteModule},null,8,["onClick"])]),default:h(()=>[O]),_:1},8,["visible"]),i(C,{rows:3,onPage:s.list,totalRecords:l.count},null,8,["onPage","totalRecords"])])])}const K=f(V,[["render",F],["__scopeId","data-v-9337c6eb"]]),j={name:"ModuleList",components:{ModuleListVue:K}},G={class:"grid w-8 m-auto"};function H(e,t,o,a,l,s){const c=n("ModuleListVue");return p(),m("div",G,[i(c)])}const z=f(j,[["render",H]]);export{z as default};
