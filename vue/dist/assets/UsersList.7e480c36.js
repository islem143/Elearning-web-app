import{_ as I,g,K as L,o as u,c,a as r,b as l,w as a,F as w,j as v,i as C,f as M,t as b,r as h,p as T,d as B}from"./index.ae1caef1.js";import{u as F,r as U,a as _,c as x}from"./index.esm.19565990.js";const O={setup(){return{v$:F()}},data(){return{roles:[{name:"teacher"},{name:"student"}],users:[],userDialog:!1,deleteUserDialog:!1,deleteUsersDialog:!1,user:{name:null,email:null,role:null,password:null,password_confirmation:null},selectedUsers:null,filters:{},submitted:!1,editMode:!1,statuses:[{label:"INSTOCK",value:"instock"},{label:"LOWSTOCK",value:"lowstock"},{label:"OUTOFSTOCK",value:"outofstock"}]}},userService:null,created(){g.get("/api/users").then(o=>{this.users=o.data}),this.initFilters()},validations(){let o={};return this.editMode?o={user:{name:{required:U},password:{minLength:this.user.password?_(5):{},checkPasswodrd:this.user.password?x.withMessage("No Matching Passwordrs",e=>e&&e===this.user.password_confirmation):{}},password_confirmation:{minLength:this.user.password_confirmation?_(5):{},checkPasswodrd:this.user.password?x.withMessage("No Matching Passwordrs",e=>e&&e===this.user.password):{}}}}:o={user:{name:{required:U},email:{required:U},password:{minLength:_(5),checkPasswodrd:x.withMessage("No Matching Passwordrs",e=>e&&e===this.user.password_confirmation)},password_confirmation:{minLength:_(5),checkPasswodrd:x.withMessage("No Matching Passwordrs",e=>e&&e===this.user.password)}}},o},methods:{setRole(o){this.user.role=o.value},errorMessages(o){const e=[];if(!this.v$.user[o].$dirty)return e;for(const i of this.v$.user[o].$errors)e.push(i.$message);return e},openNew(){this.user={},this.submitted=!1,this.userDialog=!0},hideDialog(){this.userDialog=!1,this.submitted=!1},async saveUser(){if(this.submitted=!0,!!await this.v$.$validate()){if(this.editMode)g.put("/api/users/"+this.user.id,this.user).then(e=>{let i=this.users.findIndex(m=>m.id==this.user.id);console.log(e.data),this.users.splice(i,1,e.data),this.editMode=!1,this.$toast.add({severity:"success",summary:"Successful",detail:"user updated",life:3e3})});else{let e={...this.user,role:this.user.role.name};g.post("/api/users",e).then(i=>{this.users.push(i.data),this.$toast.add({severity:"success",summary:"Successful",detail:"user creatd",life:3e3})})}this.userDialog=!1}},editUser(o){this.user={...o},this.editMode=!0,this.userDialog=!0},confirmDeleteuser(o){this.user=o,this.deleteUserDialog=!0},deleteUser(){g.delete("/api/users/"+this.user.id).then(o=>{this.users=this.users.filter(e=>e.id!==this.user.id),this.deleteUserDialog=!1,this.user={},this.$toast.add({severity:"success",summary:"Successful",detail:"user Deleted",life:3e3}),this.deleteUserDialog=!1})},findIndexById(o){let e=-1;for(let i=0;i<this.users.length;i++)if(this.users[i].id===o){e=i;break}return e},createId(){let o="";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)o+=e.charAt(Math.floor(Math.random()*e.length));return o},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){this.deleteUsersDialog=!0},deleteSelectedUsers(){for(const o of this.selectedUsers)g.delete("/api/users/"+this.user.id).then(e=>{this.users=this.users.filter(i=>i.id!==o.id),this.deleteUserDialog=!1,this.user={},this.deleteUserDialog=!1}).catch(e=>{}),this.$toast.add({severity:"success",summary:"Successful",detail:"users Deleted successfully",life:3e3});this.deleteUsersDialog=!1,this.selectedUsers=null},initFilters(){this.filters={global:{value:null,matchMode:L.CONTAINS}}}}},p=o=>(T("data-v-fe83b098"),o=o(),B(),o),R={class:"card"},A={class:"table-header flex flex-column md:flex-row md:justiify-content-between"},E=p(()=>r("h5",{class:"mb-2 md:m-0 p-as-md-center"},"Manage users",-1)),K={class:"p-input-icon-left"},j=p(()=>r("i",{class:"pi pi-search"},null,-1)),z=["src"],Y={class:"w-full md:w-10 mx-auto"},q=p(()=>r("label",{for:"name",class:"block text-900 text-xl font-medium mb-2"},"Name",-1)),W={class:"p-error"},G=p(()=>r("label",{for:"email1",class:"block text-900 text-xl font-medium mb-2"},"Email",-1)),H={class:"p-error"},J=p(()=>r("label",{for:"password1",class:"block text-900 font-medium text-xl mb-2"},"Role",-1)),Q=p(()=>r("label",{for:"password1",class:"block text-900 font-medium text-xl mb-2"},"Password",-1)),X={class:"p-error"},Z=p(()=>r("label",{for:"password2",class:"block text-900 font-medium text-xl mb-2"},"Password Confirmation",-1)),$={class:"p-error"},ee={class:"confirmation-content"},se=p(()=>r("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),te={key:0},le={class:"confirmation-content"},oe=p(()=>r("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),re={key:0};function ie(o,e,i,m,t,n){const d=h("Button"),S=h("Toolbar"),k=h("InputText"),f=h("Column"),V=h("DataTable"),P=h("Dropdown"),D=h("Password"),y=h("Dialog");return u(),c("div",null,[r("div",R,[l(S,{class:"mb-4"},{start:a(()=>[l(d,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:n.openNew},null,8,["onClick"]),l(d,{label:"Delete",icon:"pi pi-trash",class:"p-button-danger",onClick:n.confirmDeleteSelected,disabled:!t.selectedUsers||!t.selectedUsers.length},null,8,["onClick","disabled"])]),end:a(()=>[l(d,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:e[0]||(e[0]=s=>n.exportCSV(s))})]),_:1}),l(V,{ref:"dt",value:t.users,selection:t.selectedUsers,"onUpdate:selection":e[2]||(e[2]=s=>t.selectedUsers=s),dataKey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} users",responsiveLayout:"scroll"},{header:a(()=>[r("div",A,[E,r("span",K,[j,l(k,{modelValue:t.filters.global.value,"onUpdate:modelValue":e[1]||(e[1]=s=>t.filters.global.value=s),placeholder:"Search..."},null,8,["modelValue"])])])]),default:a(()=>[l(f,{selectionMode:"multiple",style:{width:"3rem"},exportable:!1}),l(f,{header:"Image"},{body:a(s=>[r("img",{src:"http://localhost:8081/images/"+s.data.profile.img_url,class:"user-image"},null,8,z)]),_:1}),l(f,{field:"id",header:"Id",sortable:!0,style:{"min-width":"12rem"}}),l(f,{field:"email",header:"Email",style:{"min-width":"16rem"}}),l(f,{field:"name",header:"Name",style:{"min-width":"16rem"}}),l(f,{field:"role",header:"Role",style:{"min-width":"10rem"}}),l(f,{exportable:!1,style:{"min-width":"8rem"}},{body:a(s=>[l(d,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:N=>n.editUser(s.data)},null,8,["onClick"]),l(d,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning",onClick:N=>n.confirmDeleteuser(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"])]),l(y,{visible:t.userDialog,"onUpdate:visible":e[16]||(e[16]=s=>t.userDialog=s),style:{width:"450px"},header:"user Details",modal:!0,class:"p-fluid"},{footer:a(()=>[l(d,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:n.hideDialog},null,8,["onClick"]),l(d,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:n.saveUser},null,8,["onClick"])]),default:a(()=>[r("div",Y,[q,l(k,{id:"name",modelValue:t.user.name,"onUpdate:modelValue":e[3]||(e[3]=s=>t.user.name=s),type:"text",class:"w-full mb-3",placeholder:"Name",style:{padding:"1rem"},onInput:e[4]||(e[4]=s=>m.v$.user.name.$touch()),onBlur:e[5]||(e[5]=s=>m.v$.user.name.$touch())},null,8,["modelValue"]),(u(!0),c(w,null,v(n.errorMessages("name"),s=>(u(),c("p",W,b(s),1))),256)),G,l(k,{disabled:t.editMode,id:"email1",modelValue:t.user.email,"onUpdate:modelValue":e[6]||(e[6]=s=>t.user.email=s),type:"text",class:"w-full mb-3",placeholder:"Email",style:{padding:"1rem"},onInput:e[7]||(e[7]=s=>!t.editMode&&m.v$.user.email.$touch()),onBlur:e[8]||(e[8]=s=>!t.editMode&&m.v$.user.email.$touch())},null,8,["disabled","modelValue"]),t.editMode?C("",!0):(u(!0),c(w,{key:0},v(n.errorMessages("email"),s=>(u(),c("p",H,b(s),1))),256)),J,l(P,{disabled:t.editMode,onChange:n.setRole,modelValue:t.user.role,"onUpdate:modelValue":e[9]||(e[9]=s=>t.user.role=s),options:t.roles,class:"mt-2",optionLabel:"name",placeholder:"Select an Answer"},null,8,["disabled","onChange","modelValue","options"]),Q,l(D,{id:"password1",modelValue:t.user.password,"onUpdate:modelValue":e[10]||(e[10]=s=>t.user.password=s),placeholder:"Password",toggleMask:!0,class:"w-full mb-3",inputClass:"w-full",inputStyle:"padding:1rem",onInput:e[11]||(e[11]=s=>m.v$.user.password.$touch()),onBlur:e[12]||(e[12]=s=>m.v$.user.password.$touch())},null,8,["modelValue"]),(u(!0),c(w,null,v(n.errorMessages("password"),s=>(u(),c("p",X,b(s),1))),256)),Z,l(D,{id:"password2",modelValue:t.user.password_confirmation,"onUpdate:modelValue":e[13]||(e[13]=s=>t.user.password_confirmation=s),placeholder:"Password Confirmation",toggleMask:!0,class:"w-full mb-3",inputClass:"w-full",inputStyle:"padding:1rem",onInput:e[14]||(e[14]=s=>m.v$.user.password_confirmation.$touch()),onBlur:e[15]||(e[15]=s=>m.v$.user.password_confirmation.$touch())},null,8,["modelValue"]),(u(!0),c(w,null,v(n.errorMessages("password_confirmation"),s=>(u(),c("p",$,b(s),1))),256))])]),_:1},8,["visible"]),l(y,{visible:t.deleteUserDialog,"onUpdate:visible":e[18]||(e[18]=s=>t.deleteUserDialog=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[l(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[17]||(e[17]=s=>t.deleteUserDialog=!1)}),l(d,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:n.deleteUser},null,8,["onClick"])]),default:a(()=>[r("div",ee,[se,t.user?(u(),c("span",te,[M("Are you sure you want to delete "),r("b",null,b(t.user.name),1),M("?")])):C("",!0)])]),_:1},8,["visible"]),l(y,{visible:t.deleteUsersDialog,"onUpdate:visible":e[20]||(e[20]=s=>t.deleteUsersDialog=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:a(()=>[l(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[19]||(e[19]=s=>t.deleteUsersDialog=!1)}),l(d,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:n.deleteSelectedUsers},null,8,["onClick"])]),default:a(()=>[r("div",le,[oe,t.user?(u(),c("span",re,"Are you sure you want to delete the selected users?")):C("",!0)])]),_:1},8,["visible"])])}const de=I(O,[["render",ie],["__scopeId","data-v-fe83b098"]]);export{de as default};
